# About

This package was developed for upgrading the metadata from CDAWeb's HAPI servers.

The code reads metadata from CDAWeb "masters", lists of files associated with each CDAWeb dataset, and SPASE records referenced in the masters and outputs

1. A file containing all metadata associated with each CDAWeb dataset, including information in all.xml and master CDFs, and the list of CDF files.
2. HAPI metadata
3. SQL tables of [CDAWeb](https://hapi-server.org/meta/cdaweb/), [HAPI](https://hapi-server.org/meta/hapi/), and SPASE metadata

Metadata generated by this code is available at http://mag.gmu.edu/git-data/cdawmeta/data

# Running

```
git clone https://github.com/rweigel/cdawmeta.git
cd cdawmeta
make hapi-new
```

See the comments in `Makefile` for additional execution options.

The Makefile command above executes the following

```
python cdaweb.py         # creates data/cdaweb.json
python hapi/hapi-new.py  # creates data/hapi/hapi-new.json and
                         # data/info/*.json using data/catalog-all.json
```

# Compare

To compare the new HAPI metadata with Nand's, first execute `cdaweb.py` then

```
python hapi/hapi-nl.py   # creates data/hapi/catalog-all.nl.json using requests to
                         # https://cdaweb.gsfc.nasa.gov/hapi/{catalog,info}
make compare [--include='PATTERN'] # creates data/hapi/compare.log
# PATTERN is a dataset ID regular expression, e.g., '^AC_'
```

# Browse and Search

See `table/README.md` for browsing and searching metadata from a web interface.
